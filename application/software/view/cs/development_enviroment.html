{include file="template/header" title="C# 开发环境" /}
<div class="list list-number">
	<div class="title">Visual Studio各种版本</div>
	<div class="content closed">
		<table class="table table-bordered table-sm">
			<tbody>
				<tr>
					<th>名称</th>
					<th>内部版本</th>
					<th>支持.NET Framework版本</th>
				</tr>
				<tr>
					<td>Visual Studio .NET 2002</td>
					<td>7.0</td>
					<td>1.0</td>
				</tr>
				<tr>
					<td>Visual Studio .NET 2003</td>
					<td>7.1</td>
					<td>1.1</td>
				</tr>
				<tr>
					<td>Visual Studio 2005</td>
					<td>8.0</td>
					<td>2.0</td>
				</tr>
				<tr>
					<td>Visual Studio 2008</td>
					<td>9.0</td>
					<td>3.5</td>
				</tr>
				<tr>
					<td>Visual Studio 2010</td>
					<td>10.0</td>
					<td>4.0</td>
				</tr>
				<tr>
					<td>Visual Studio 2012 RTM</td>
					<td>11.0</td>
					<td>4.6.2</td>
				</tr>
				<tr>
					<td>Visual Studio 2013</td>
					<td>12.0</td>
					<td>4.6.2</td>
				</tr>
				<tr>
					<td>Visual Studio 2015</td>
					<td>14.0</td>
					<td>4.6.2</td>
				</tr>
				<tr>
					<td>Visual Studio 2015 RTM</td>
					<td>14.0</td>
					<td>4.6.2</td>
				</tr>
				<tr>
					<td>Visual Studio 2017</td>
					<td></td>
					<td></td>
				</tr>
			</tbody>
		</table>

	</div>

	<div class="title">自定义开发环境</div>
	<div class="content closed">
		<div class="list list-number">
			<div class="title">恢复IDE设置</div>
			<div class="content closed">
				<p>如第一次运行VS, IDE选择了VB的设置, 但是希望改成C#的设置, 只需要单击Tools菜单上的Imports and Export Settings...</p>
			</div>

			<div class="title">字型&色彩</div>
			<div class="content closed">
				<p>
					工具 -> 选项 -> 环境 -> 字型和色彩 ... <br>
					字体: YaHei Consolas Hybird <br>
					字串 / String: 改为红色 <br>

				</p>
			</div>

			<div class="title">花括号换行</div>
			<div class="content closed">
				<p>工具 -> 选项 -> 文字编辑器 -> C# -> 新行 ...</p>
			</div>
		</div>
	</div>

	<div class="title">开发环境小技巧</div>
	<div class="content closed">
		<div class="list list-number">
			<div class="title">VS 2005 OOP工具</div>
			<div class="content closed">
				<p>
					1) 查看当前项目中的类: Class View窗口, Ctrl + W, C <br>
					2) 查看当前项目&外部的类: Object Browser, Ctrl + W, J <br>
					3) 查看UML图: 类图, 在Solution Explorer中选择相应的类文件, 单击上面的View Class Diagram按钮.
				</p>
			</div>

			<div class="title">竖向选择</div>
			<div class="content closed">
				<p>按住Alt, 然后鼠标框选.</p>
			</div>

			<div class="title">自动引用命名空间</div>
			<div class="content closed">
				<p>右击类(或者ctrl + alt + F10), 选择解析...</p>
			</div>

			<div class="title">如何删除事件</div>
			<div class="content closed">
				<p>如果直接删除事件处理程式, 则会报错, 必须要再手动删除事件订阅, 但是在属性窗口中可以直接删除事件.</p>
			</div>

			<div class="title">动态帮助</div>
			<div class="content closed">
				<p>如果启用动态帮助, 将出现动态帮助窗口, 其中显示了一个与正在进行的工作相关的主题列表. 初学.Net时非常有用.</p>
			</div>

			<div class="title">自动保存</div>
			<div class="content closed">
				<p>在运行程序之前, VB 2005会自动保存程序文件.</p>
			</div>

			<div class="title">锁定控件</div>
			<div class="content closed">
				<p>从菜单中选择Format|Lock Controls. 可以将每个控件的Locked属性设置为True, 以防止他们不小心被移动, 改变大小或者删除.</p>
			</div>

			<div class="title">快速输入代码</div>
			<div class="content closed">
				<p>
					快速添加事件处理程序: 在输入+=运算符之后, 只需按下Tab键两次, 编辑器就会完成剩余的输入工作. <br>
					快速定义属性： 先输入prop，然后按两次Tab. <br>
					插入代码段：Ctrl+K，X。如果你想快速的输入代码，这个必须记住。配合F2一起用，那将会成为一把利器。<br>
					使用“Ctrl+K，S”，你可以更快速的输入像try和#Region一样的代码段。<br>
					输入cw, 出现如下图所示, 然后按两下Tab, IDE会自动插入"Console.WriteLine()", 且光标在括号内等待输入. <br>
					<img src="__ROOT__/static/image/cs/快速插入代码段.png"><br>
					<span class="text-danger">备注: 出现只能提示时, 一般按两下tab键, 可以快速插入...</span>
				</p>
			</div>

			<div class="title">在项目中快速移动文件</div>
			<div class="content closed">
				<p>按住shift, 鼠标拖放.</p>
			</div>

			<div class="title">Immediate窗口 - Ctrl + Alt + I</div>
			<div class="content closed">
				<p>可以执行源代码, 计算表达式, 还可以执行其他代码.</p>
			</div>

			<div class="title">Command窗口 - Ctrl + Alt + A</div>
			<div class="content closed">
				<p>可以手动执行VS操作(例如菜单和工具栏操作</p>
			</div>

			<div class="title">调用堆栈窗口 - Ctrl + Alt + C</div>
			<div class="content closed">
				<p>查看调用堆栈信息.</p>
			</div>

			<div class="title">更有效的剪切板</div>
			<div class="content closed">
				<p>
					1. 循环剪切板: Shift + Ctrl + V . 调用这个快捷键就可以把之前多次的复制记录都粘贴出来. <br>
					2. 整行剪切：Ctrl + X. 光标不要选中任何文字，然后按这个快捷键就可以把整行剪切下来. <br> 
					3. 整行复制：Ctrl + C. 这个和Ctrl + X的使用方法一样.
				</p>
			</div>

			<div class="title">选择</div>
			<div class="content closed">
				<p>
					1. 基本选择：Shift + 光标（←↓↑→） . 基于光标所在的地点，按住Shift然后使用上下左右光标可以自由选择. <br>
					2. 基于单词选择：Shift + Ctrl+（→←）. 使用这个可以跳跃单词的选，也可配合Home/End选择整行. <br>
					3. 基于“方块”选择：Shift + Alt + (←↓↑→) 或者Alt + 鼠标. <br>
					4. 选择一个整个单词：Shift + Ctrl + W. 把光标放在某个单词中的时候按快捷键即可.
				</p>
			</div>

			<div class="title">搜索&查找</div>
			<div class="content closed">
				<p>
					查找所有引用： Shit + F12; <br><br>
					Ctrl + I(Incremental): 按住快捷键然后输入要查询的字符串，VS会马上定位到, 而不需要像Ctrl + F那种确认的过程. 移动到下一个匹配按Ctrl + I, 移动到上一个Shift + Ctrl + I. <br>
					Ctrl + F(Find)：可以指定更多的条件，如是否匹配大小写、是否整词搜索、是否用正则表达式以及搜索的范围. <br>
					Ctrl + Shift + F，这个可以实现的搜索功能与Ctrl + F 一模一样，唯一不同就是这个可以将你搜索的结果输出到查找结果窗口中，而不是一个一个显示出来.
				</p>
			</div>

			<div class="title">全屏模式</div>
			<div class="content closed">
				<p>Shift + Alt + Enter. 可以让你进入全屏无干扰模式，本人很喜欢这个功能.</p>
			</div>
			<div class="title">更有效的只能感知</div>
			<div class="content closed">
				<p>
					1. 列出成员: Ctrl + J 或者Ctrl + K + L（List Member）<br>
					当我们需要访问对象方法的时候按, VS会自动提示出有哪些方法，但是有时候我们需要在操作符已经存在的情况下再查看. 以前我会把点删掉然后再点一次，我承认我当时很傻，后来知道这个快捷键以后就好多了. <br><br>

					2. 列出选项: Ctrl + . 或者Ctrl + Shift +F10 <br>
					当我们用到一些类型在我们工程引用的程序集里, 但是没有在当前文件引用的命名空间内时，或者我们写了一个不存在的函数时，那行代码会有错误提示，并且在左下角有一个小符号. 这个快捷键就是在不移动鼠标的情况下让其出现这个提示. <br><br>

					3. 强迫显示参数信息：Ctrl-Shift-空格 <br><br>

					4. 显示函数原型: Ctrl + K, Ctrl + I <br><br>
				</p>
			</div>

			<div class="title">跳转</div>
			<div class="content closed">
				<p>
					1. 基于单词的跳转：Ctrl + (←→). 此快捷键可以让光标以单词为单位左右进行跳转. <br>
					2. 跳到上一个本单词： Shift + Ctrl +（↓↑） . 这个功能比较有用，可以将光标移动到光标所在的那个单词上次或者下次在文中出现的地方. <br>
					3. 跳到上一个光标停留的地方： Ctrl + -（往前）；Ctrl + Shift + - （往后） <br>
					4. 快速跳转到某一行： Ctrl + G <br>
					5. 快速跳到文件头尾：Ctrl + Home/End <br>
					6. 快速跳转到本行第一个非空格开头：Home. 如果要到本行最开头则按两下Home即可. <br>
					7. 快速跳转到本行结尾：End <br>
					8. 匹配括号移动：Ctrl + ]，适用于 (), {}, [], “” . 将光标放在需要匹配的括号然后按这个快捷键，光标会跳转到其相对于那个的括号上去. <br>
					这个功能比较有用，但是我还有一个建议. Visual Studio本来就会将相对应的括号给特别标识出来，只是一般默认的那个颜色和背景颜色比较类似看不出来，建议将其在Font And Colors中设置成醒目的颜色. <br>
					9. 快速跳转到函数开始/结束: Alt + ↓/↑
				</p>
			</div>

			<div class="title">任务列表</div>
			<div class="content closed">
				<p>Ctrl + W + T: 写代码的时候我们往往会遇到这种情况，某一些代码我们现在不确定需求, 或者觉得可能会有问题将来需要改善，我们会加上注释：//TODO：reason. 这个任务列表的功能就是让我们可以看到我们当前工程中有多少个TODO项.</p>
			</div>
		</div>
	</div>

	<div class="title">调试</div>
	<div class="content closed">
		<div class="list list-number">
			<div class="title">输出调试信息</div>
			<div class="content closed">
				<p>
					Debug: 可以输出调试信息到"输出"窗口, 仅限于Debug模式. <br>
					Trace: 可以输出调试信息到"输出"窗口, Debug和Release模式都可以.
				</p>
			</div>

			<div class="title">断言</div>
			<div class="content closed">
				<p>
					Debug.Assert(condition, message, detailMessage); <br>
					断言assert是仅在Debug版本起作用的宏, 它用于检查“不应该”发生的情况. 如果是Release版本, 编译器忽略所有的断言（看成空语句）.
				</p>
			</div>

			<div class="title">Release模式</div>
			<div class="content closed">
				<p>在把编译配置从Debug改为Release后, 就不能调试程序了, 即使在代码中设置了断点,  代码也不会暂停.</p>
			</div>

			<div class="title">卸载&加载项目</div>
			<div class="content closed">
				<p>一个方案中含有多个项目, 但是其中某个项目有问题, 导致其他项目不能运行, 可以暂时先把有问题的项目卸载掉, 等有时间了再加载进来修改.</p>
			</div>
		</div>
	</div>

	<div class="title">编译</div>
	<div class="content closed">
		<div class="list list-number">
			<div class="title">自动生成版本号</div>
			<div class="content closed">
				<p>
					只需把 AssemblyInfo.cs文件中的 <br>
					[assembly:AssemblyVersion("1.0.0.0")]改成 <br>
					[assembly:AssemblyVersion("1.0.*")]，另外还需要把 <br>
					[assembly:AssemblyFileVersion("1.0.0.0")]注释屏蔽掉。这样再生成的程序集就是自动版本号了。 <br>
					按照这个格式出来的版本号，内部修订版本号（第三个字段）的位置出现的是2000年1月1日到编译日期的天数，内部修订号（第四个字段）是当天从0点到当前时间的刻度数。
				</p>
			</div>

			<!--条件编译-->
			<div class="title">条件编译</div>
			<div class="content closed">
				<p>条件编译可以根据定义不同符号, 编译出不同版本的程式!</p>

				<p class="text-strong">定义符号</p>
				<div class="container-fluid pl-0">
					<div class="row">
						<div class="col-1">1) 源文件: </div>
						<div class="col-2">#define DEBUG & #undef DEBUG</div>
					</div>
					<div class="row">
						<div class="col-1">2) 编译时: </div>
						<div class="col-2">编译时使用define参数: /define:name[;name2] </div>
					</div>
					<div class="row">
						<div class="col-1">3) 指定项目属性: </div>
						<div class="col-4">Project Property--->Build--->Conditional compilation symbols, 如果定义多个可使用逗号隔开</div>
					</div>
				</div>

				<p class="text-strong">使用范围</p>
				<p>用 #define 创建的符号的使用范围是当前文件.</p>
			</div>

			<div class="title">x86 vs x64</div>
			<div class="content closed">
				<p>
					any: 程序在第一次运行的时候会根据环境预编译成对应系统最适合的. <br>
					x86: 只能在x86和64上运行, 但是在64上运行的优化肯定没选any或64好. <br>
					x64: 只能在x64上面运行.
				</p>
				<p class="text-danger">注: 如果加载了32位DLL,而且要在64位OS上运行, 则必须编译成x86, 否则会出错!</p>
			</div>

			<!--Build Event-->
			<div class="title">Build Event</div>
			<div class="content closed">
				<a href="https://blog.csdn.net/norsd/article/details/10575217">网络资料</a>	
			</div>

			<!--#warning & #error-->
			<div class="title">编译警告&错误: #warning, #error & #pgagma</div>
			<div class="content closed">
				<p class="text-strong">自定义编译警告&错误</p>
				<pre class="prettyprint linenums">
<code>// 如果编译器遇到#warning指令, 会给用户显示#warning指令后面的文本, 之后编译继续进行.
#if DEBUG && RELEASE
    #error "You've defined DEBUG and RELEASE simulataneously!"
#endif

// 如果编译器遇到#error指令, 就会给用户显示后面的文本, 作为一个编译错误信息, 然后会立即退出编译, 不会生成IL代码.
#warning "Don't forget to remove this line the boss tests the code!"
    Console.WriteLine("*I have this job*");
</code>
				</pre>

				<p class="text-strong">抑制&恢复某个编译警告</p>
				<pre class="prettyprint linenums">
<code>
#pragma warning disable 169
    public class MyClass
    {
        int neverUsedField;
    }
#pragma warning restore 169
</code>
				</pre>

				<p>以上只能抑制(恢复)某个文件中的某个警告, 也可以在项目属性中设置(项目属性 -> 建置 -> 错误和警告 -> 隐藏警告...), 在某个项目中抑制某个警告!</p>
			</div>
		</div>	
	</div>

	<!--#if DEBUG va Debugger.IsAttached-->
	<div class="title">#if DEBUG vs Debugger.IsAttached</div>
	<div class="content closed">
		<div class="container-fluid">
			<div class="row">
				<div class="col-1">#if DEBUG</div>
				<div class="col-2">DEBUG代码不会编译到程序集中</div>
			</div>
			<div class="row">
				<div class="col-1">Debugger.IsAttached</div>
				<div class="col-10">
					Gets a value that indicates whether a debugger is attached to the process.<br>
					在开发环境中允许代码, 不管是Debug模式, 还是Release模式, 都会返回true. 运行执行挡时, 如果Debugger Attached, 也会返回true.(执行挡怎么Attach Debugger?)
				</div>
			</div>
		</div>
	</div>

	<!--NuGet-->
	<div class="title">NuGet</div>
	<div class="content closed">
		<p>
			<strong>什么是NuGet?</strong><br>
			通俗来说, NuGet是用来管理引用的!
		</p>
		<p>
			<strong>安装Dapper失败, 怎么办?</strong><br>
			离线安装旧版可以解决!<br>            
			例如: install-package dapper -version 1.50.2 -source C:\Users\Jack_Ku\AppData\Local\NuGet\Cache\
		</p>
	</div>



	<div class="title">常用工具&插件</div>
	<div class="content closed">
		<div class="list list-number">
			<div class="title">Visual Assist</div>
			<div class="content open">
				<p>老牌插件</p>
			</div>

			<div class="title">Ildasm.exe</div>
			<div class="content open">
				<p>
					微软的IL反编译实用程序——Ildasm.exe，可以对可执行文件（ex，经典的控制台Hello World 的 exe 可执行文件）抽取出 IL 代码，并且给出命名空间以及类的视图. <br>
					在VS 2005中的路径: "C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\ildasm.exe"
				</p>
			</div>
		</div>
	</div>

	<div class="title">常见错误</div>
	<div class="content closed">
		<div class="list list-number">
			<div class="title">錯誤: 名稱 'Jack4net' 不存在於目前內容中</div>
			<div class="content closed">
				<p>
					命名引用了参考, 却找不到相应的命名空间和类! <br>
					确认一下项目是否使用了错误的Framework, 比如使用了.NET Framework 4 Client Profile?
				</p>
			</div>

			<div class="title">使用Ado.Net时报错: Incorrect syntax near the keyword 'File'</div>
			<div class="content closed">
				<p>
					File是SQL Server关键字, 不能作为表名, 字段名, 需要添加中括号括起来. <br>
					怪不得SQL Sever自动生成的SQL语句会自动添加中括号!
				</p>
			</div>

			<div class="title">运行Jack4net.Log.LogService报错: The type initializer for 'Jack4net.Log.LogService' threw an exception.</div>
			<div class="content closed">
				<p>
					项目中引用了Jack4net.dll和log4net.dll, 把log4net.dll的引用去掉就可以了.
				</p>
			</div>

			<div class="title">调试程式时出现there is no source code available for the current location</div>
			<div class="content closed">
				<p>
					1) Clean Solution <br>
					2) Rebuild Solution
				</p>
			</div>

			<div class="title">剖析EntityName時發生錯誤. 第2行, 位置60.</div>
			<div class="content closed">
				<p>檢查一下文件(或文件夾)中是否有特殊字符, 比如: "&"</p>
			</div>

			<div class="title">Form显示出错</div>
			<div class="content closed">
				<p>检查路径中是否有中文字符, "&"字符等等.</p>
			</div>

			<div class="title">警告 1 無法剖析 ResX 檔 型別 'System.Collections.Generic.List`1[Simplo.TestFiles.TestItems.TestItem]' 的物件無法轉換成型別 'System.Collections.Generic.List`1[Simplo.TestFiles.TestItems.TestItem]'。 第 133 行，位置 5。。 133 0</div>
			<div class="content closed">
				<p>试着查看窗体/控件的.resx中是否有可疑的资源(一般是没有什么资源的), 可以删除试一下.</p>
			</div>

			<div class="title">Code Snippet titled [Method Stub - Body] failed to load. Verify that refactoring are recognized in the Code Snippet Manager and that the snippet files are valid on disk.</div>
			<div class="content closed">
				<p>
					如果你在使用VS 2005,如果你不能使用它的Code Snippet功能，如果你在实现抽象类override 方法时弹出：
				</p>

				<p>
					Code Snippet titled [Method Stub - Body] failed to load. Verify that refactoring snippets are recognized in the Code Snippet Manager and that the snippet files are valid on disk.</p>

				<p>
					这段提示信息告诉我们指定的Code Snippet块无法找到，很多人可能会由于这个原因去修复安装VS 2005。其实解决办法很简单，只要重新导入Code Snippet块就行了。找到并打开Code Snippet Manager(Ctrl + K,Ctrl + B)，然后选择要操作的语言(C#)，用Add按钮导入两个默认的文件夹：Refactoring和Visual C#，这两个文件夹一般会在VS2005安装目录下的，如：C:/Program Files/Microsoft Visual Studio 8/VC#/Snippets/1033 .
				</p>
			</div>

			<div class="title">Function evaluation is disabled because a previous function evaluation timed out</div>
			<div class="content closed">
				<p>Function evaluation is disabled because a previous function evaluation timed out. To re-enable function evaluation, step again or restart debugging. In the Visual Studio debugger, an expression specifies a procedure call, but another evaluation has timed out. Possible causes for a procedure call to time out include an infinite loop or endless loop.</p>
			</div>

			<div class="title">錯誤 17 找不到型別或命名空間名稱 'Simplo' (您是否遺漏 using 指示詞或組件參考?)</div>
			<div class="content closed">
				<p>
					将应用程序框架由.NET Framework 4 Client Profile改为.NET Framework 4. <br>
					说明： <br>
					.NET Framework 4是.net的一个完整的开发框架和运行框架 <br>
					.NET Framework 4 Client Profile是 .NET Framework 4的一个精简，.NET Framework 4 Client Profile的目的是改进和帮助精简客户端应用的部署大小，部署时间，可靠性和总的部署体验
				</p>
			</div>
		</div>
	</div>
</div>
{include file="template/footer" /}